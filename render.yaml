services:
  - type: web
    name: camerainstallationweb
    runtime: python3
    buildCommand: pip install -r requirements.txt; python manage.py collectstatic --noinput
    startCommand: gunicorn camerainstallationweb.wsgi:application --bind 0.0.0.0:$PORT
    envVars:
      - key: DEBUG
        value: False
      - key: SECRET_KEY
        generateValue: true
      - key: ALLOWED_HOSTS
        value: security-systems.onrender.com,localhost,127.0.0.1
      - key: EMAIL_HOST_USER
        value: "" # Set in Render dashboard (do NOT commit secrets to repo)
      - key: EMAIL_HOST_PASSWORD
        value: "" # Set in Render dashboard as a secret (Gmail App Password)
      - key: DEFAULT_FROM_EMAIL
        value: "" # Optional; defaults to EMAIL_HOST_USER if left empty
      - key: LOG_LEVEL
        value: DEBUG
      - key: TEST_EMAIL_RECIPIENT
        value: "" # Optional: set to test recipient or run one-off job with env override
  # Define a one-off job you can run from the Render dashboard to test email sending
  - type: job
    name: send-test-email
    runtime: python3
    plan: free
    shell: python
    # This job will use the same build commands as the web service; it runs the
    # management command to send a test email. Fill secrets in the dashboard.
    buildCommand: pip install -r requirements.txt
    startCommand: python manage.py send_test_email
    envVars:
      - key: EMAIL_HOST_USER
        value: "" # Set in Render dashboard (secret)
      - key: EMAIL_HOST_PASSWORD
        value: "" # Set in Render dashboard (secret)
      - key: DEFAULT_FROM_EMAIL
        value: "" # Optional
      - key: LOG_LEVEL
        value: DEBUG
      - key: TEST_EMAIL_RECIPIENT
        value: "" # Optional: override recipient